div(class="border-b border-neutral-200")
    div(class="flex items-center py-3 px-4 text-left bg-neutral-800")
        img(class="bg-neutral-100 rounded-lg bg-contain bg-center bg-cover bg-no-repeat size-8 mr-2", style="background-image: url({{wikibook.data().icon}})", (click)="updateIcon()")
        div(class="flex flex-auto items-center flex-1 text-base font-semibold text-white break-all whitespace-break-spaces pl-1 cursor-pointer", *ngIf="wikibook.data().title", [routerLink]="wikibook.uistat.contentLink('home')") {{wikibook.data().title}}
        div(class="flex items-center gap-2 ml-auto text-white/70", *ngIf="wikibook.accessLevel(['admin'])")
            a(class="hover:text-white transition-colors", [routerLink]="'/wikidownload/' + wikibook.data().id", target="_blank")
                i(class="ti ti-download text-lg")
            i(class="ti ti-settings text-lg hover:text-white transition-colors cursor-pointer", [routerLink]="wikibook.uistat.contentLink('setting')")

    div(class="flex bg-neutral-50 divide-x divide-neutral-200 text-sm", *ngIf="wikibook.accessLevel(['admin', 'user'])")
        button(class="flex-1 py-2 text-blue-600 hover:bg-blue-50 transition-colors", (click)="newContent()")
            span 문서생성
            i(class="ti ti-plus ml-2 text-base")

        button(class="flex-1 py-2 text-blue-600 hover:bg-blue-50 transition-colors", (click)="create(treeConfig.rootNode())")
            span 그룹생성
            i(class="ti ti-folder-plus ml-2 text-base")

div(class="flex-auto overflow-y-auto overflow-x-hidden text-sm")
    div(class="p-3")
        ng-container(*ngIf="treeConfig.rootNode && treeConfig.rootNode().newItem")
            div(class="flex items-center w-full py-1.5 cursor-pointer hover:bg-neutral-100 rounded-md px-1 transition-colors")
                i(class="flex items-center justify-center w-5 ti ti-folder mr-2 text-neutral-400")
                div(class="flex-auto overflow-hidden whitespace-nowrap")
                    input(class="text-xs rounded-md w-full py-0.5 px-1.5 shadow-none border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="treeConfig.rootNode().newItem.title", placeholder="폴더명", (keyup.enter)="createNode(treeConfig.rootNode())")
                i(class="flex items-center justify-center w-5 ti ti-x text-red-400 ml-1.5 hover:text-red-600 cursor-pointer transition-colors", (click)="cancelCreate(treeConfig.rootNode()); $event.stopPropagation();")
                i(class="flex items-center justify-center w-5 ti ti-check text-blue-500 ml-1.5 hover:text-blue-700 cursor-pointer transition-colors", (click)="createNode(treeConfig.rootNode()); $event.stopPropagation();")

        wiz-portal-season-viewer-tree([config]="treeConfig")
            ng-template('#fileTemplate'='', let-data='')
                div(class="flex items-center w-full py-1.5 cursor-pointer hover:bg-neutral-100 rounded-md px-1 group transition-colors", [ngClass]="data.isActive() ? 'bg-neutral-100 text-neutral-900 font-medium' : 'text-neutral-600'", (click)="data.select()")
                    ng-container(*ngIf="data.id == wikibook.data().home")
                        ng-container(*ngIf="data.type == 'folder'")
                            i(class="flex items-center justify-center w-5 mr-1 ti ti-home text-neutral-500", (click)="data.toggle(); $event.stopPropagation(); service.render();")
                        ng-container(*ngIf="data.type != 'folder'")
                            i(class="flex items-center justify-center w-5 mr-1 ti ti-home text-neutral-500")

                    ng-container(*ngIf="data.id != wikibook.data().home")
                        ng-container(*ngIf="data.type == 'folder'")
                            i(class="flex items-center justify-center w-5 mr-1 ti", [ngClass]="data.isOpen() ? 'ti-chevron-down' : 'ti-chevron-right'", (click)="data.toggle(); $event.stopPropagation(); service.render();")
                        ng-container(*ngIf="data.type != 'folder'")
                            i(class="flex items-center justify-center w-5 mr-1 ti ti-file-text text-neutral-400")

                    div(class="flex-auto overflow-hidden whitespace-nowrap")
                        span(*ngIf="!data.editable") {{data.title}}
                        input(class="text-xs rounded-md w-full py-0.5 px-1.5 shadow-none border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="data.rename", placeholder="폴더명", (keyup.enter)="data.update();", *ngIf="data.editable", (click)="$event.stopPropagation();")

                    ng-container(*ngIf="data.type == 'folder'")
                        i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-folder-plus hover:text-blue-500 transition-colors", (click)="create(data); $event.stopPropagation();")
                        i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-plus hover:text-blue-500 transition-colors", (click)="createDoc(data); $event.stopPropagation();")

                ng-container(*ngIf="data.newItem")
                    div(class="pl-4")
                        div(class="flex items-center w-full py-1.5 cursor-pointer hover:bg-neutral-100 rounded-md px-1 transition-colors")
                            i(class="flex items-center justify-center w-5 ti ti-folder mr-2 text-neutral-400")
                            div(class="flex-auto overflow-hidden whitespace-nowrap")
                                input(class="text-xs rounded-md w-full py-0.5 px-1.5 shadow-none border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="data.newItem.title", placeholder="폴더명", (keyup.enter)="createNode(data)")
                            i(class="flex items-center justify-center w-5 ti ti-x text-red-400 ml-1.5 hover:text-red-600 cursor-pointer transition-colors", (click)="cancelCreate(data); $event.stopPropagation();")
                            i(class="flex items-center justify-center w-5 ti ti-check text-blue-500 ml-1.5 hover:text-blue-700 cursor-pointer transition-colors", (click)="createNode(data); $event.stopPropagation();")
