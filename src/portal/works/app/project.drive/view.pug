div(class="drive-container relative flex flex-col w-full h-full max-w-full overflow-hidden bg-white")
    //- 업로드 상태바
    ng-container(*ngIf="project.drive.status")
        div(class="fixed bottom-6 right-6 w-full max-w-64 bg-white py-3 px-4 rounded-lg border border-neutral-200 shadow-lg text-neutral-600 z-50")
            h4(class="font-medium text-sm") 파일 업로드 ({{project.drive.queue.length}}개 파일)
            div(class="text-neutral-500 text-xs mt-1") {{project.drive.current}}
            div(class="w-full h-1 bg-neutral-100 rounded-full mt-2")
                div(class="h-full bg-blue-500 rounded-full transition-all", style="width: {{project.drive.percent}}%;")

    //- 헤더
    div(class="bg-neutral-50 border-b border-neutral-200")
        div(class="flex items-center py-3 px-4")
            div(class="flex items-center font-semibold text-neutral-800 pl-2 gap-2")
                i(class="ti ti-cloud text-lg text-neutral-400")
                span 드라이브
            div(class="ml-auto flex items-center gap-2")
            ng-container(*ngIf="accessLevel()")
                button(class="inline-flex items-center gap-1.5 h-8 px-3 rounded-md bg-red-50 text-red-600 text-sm hover:bg-red-100 transition-colors", (click)="deleteSelected()", *ngIf="selected.length > 0")
                    i(class="ti ti-trash text-base")
                button(class="inline-flex items-center gap-1.5 h-8 px-3 rounded-md bg-blue-500 text-white text-sm hover:bg-blue-600 transition-colors", (click)="upload(current)")
                    i(class="ti ti-upload text-base")
                button(class="inline-flex items-center gap-1.5 h-8 px-3 rounded-md bg-blue-500 text-white text-sm hover:bg-blue-600 transition-colors", (click)="create(current, false)")
                    i(class="ti ti-folder-plus text-base")

    //- 메인 콘텐츠
    div(class="relative flex flex-auto overflow-hidden h-full")
        //- 좌측 트리 패널
        div(class="flex flex-col w-80 min-w-80 border-r border-neutral-200 h-full overflow-auto bg-neutral-50", class="max-sm:hidden")
            div(class="py-2.5 px-3 text-sm cursor-pointer transition-colors", class="max-sm:hidden", [ngClass]="tab == 'files' ? 'text-blue-600 font-medium bg-white' : 'text-neutral-500 hover:text-neutral-700'", (click)="tabChange('files')") 파일

            div(class="bg-white overflow-y-auto overflow-x-hidden",
                (drop)="treeConfig.rootNode().drop($event)",
                (dragend)="treeConfig.rootNode().dragend($event)",
                (dragover)="treeConfig.rootNode().dragover($event)",
            )
                div(class="p-3")
                    wiz-portal-season-viewer-tree([config]="treeConfig")
                        ng-template('#fileTemplate'='', let-data='')
                            div(
                                *ngIf="data.type != 'file'",
                                class="flex items-center cursor-pointer hover:bg-neutral-100 rounded-md px-1 py-0.5 group transition-colors",
                                [ngClass]="data.isActive() ? 'bg-neutral-100 text-blue-600' : 'text-neutral-600'",
                                (click)="data.select(); $event.stopPropagation();",
                                (dblclick)="open(data); $event.stopPropagation();",
                            )
                                ng-container(*ngIf="data.type == 'file'")
                                    i(class="flex items-center justify-center w-5 text-neutral-400 text-center mr-1", [ngClass]="icon(data)")
                                ng-container(*ngIf="data.type == 'folder'")
                                    i(class="flex items-center justify-center w-5 text-neutral-400 text-center mr-1 hover:text-blue-500", [ngClass]="icon(data)", (click)="data.editable = !data.editable; $event.stopPropagation(); service.render()")

                                div(class="flex-auto overflow-hidden whitespace-nowrap text-sm")
                                    span(*ngIf="!data.editable") {{data.title}}
                                    input(class="text-xs rounded-md w-full py-0.5 px-1.5 shadow-none border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="data.rename", placeholder="폴더명", (keyup.enter)="data.update();", *ngIf="data.editable", (click)="$event.stopPropagation();")

                                ng-container(*ngIf="data.type == 'folder'")
                                    i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-folder-plus hover:text-blue-500 transition-colors", (click)="create(data); $event.stopPropagation();")
                                    i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-upload hover:text-blue-500 transition-colors", (click)="upload(data); $event.stopPropagation();")
                                i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-trash hover:text-red-500 transition-colors", (click)="delete(data); $event.stopPropagation();")
                                i(class="flex items-center justify-center w-5 text-neutral-300 hidden group-hover:!flex ti ti-download hover:text-blue-500 transition-colors", (click)="download(data); $event.stopPropagation();")

                            ng-container(*ngIf="data.newItem")
                                div(class="pl-4")
                                    div(class="flex items-center cursor-pointer hover:bg-neutral-100 rounded-md px-1 py-0.5")
                                        i(class="flex items-center justify-center w-5 text-sky-400 text-center ti ti-folder mr-2")
                                        div(class="flex-auto overflow-hidden whitespace-nowrap")
                                            input(class="text-xs rounded-md w-full py-0.5 px-1.5 shadow-none border border-neutral-200 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="data.newItem.title", placeholder="폴더명", (keyup.enter)="createFolder(data)")
                                        i(class="flex items-center justify-center w-5 text-red-400 ti ti-x ml-1.5 hover:text-red-600 cursor-pointer transition-colors", (click)="cancelCreate(data); $event.stopPropagation();")
                                        i(class="flex items-center justify-center w-5 text-blue-500 ti ti-check ml-1.5 hover:text-blue-700 cursor-pointer transition-colors", (click)="createFolder(data); $event.stopPropagation();")

            div(class="py-2.5 px-3 text-sm cursor-pointer transition-colors", class="max-sm:hidden", [ngClass]="tab == 'attachment' ? 'text-blue-600 font-medium bg-white' : 'text-neutral-500 hover:text-neutral-700'", (click)="tabChange('attachment')") 이슈파일
            div(class="py-2.5 px-3 text-sm cursor-pointer transition-colors", class="max-sm:hidden", [ngClass]="tab == 'meeting' ? 'text-blue-600 font-medium bg-white' : 'text-neutral-500 hover:text-neutral-700'", (click)="tabChange('meeting')") 회의록파일
            div(class="py-2.5 px-3 text-sm cursor-pointer transition-colors", class="max-sm:hidden", [ngClass]="tab == 'photo' ? 'text-blue-600 font-medium bg-white' : 'text-neutral-500 hover:text-neutral-700'", (click)="tabChange('photo')") 사진

        //- 파일 탭
        ng-container(*ngIf="current && tab == 'files'")
            div(class="flex-auto h-full overflow-auto",
                (drop)="current.drop($event)",
                (dragend)="preventEvent($event)",
                (dragover)="preventEvent($event)",
            )
                table(class="w-full")
                    thead(class="sticky top-0 z-50 bg-neutral-50 text-xs")
                        tr(class="*:py-2.5 *:px-3")
                            th(class="w-14 text-nowrap text-center !pl-5 !pr-0", *ngIf="accessLevel()")
                                span(class="text-sm rounded-md px-2 py-0.5 cursor-pointer border transition-colors",
                                    [ngClass]="selected.length == current.getChildren().length ? 'bg-blue-500 text-white border-blue-500' : 'border-neutral-300 text-neutral-300 hover:border-neutral-400'",
                                    (click)="selectAll()",
                                )
                                    i(class="ti ti-check text-sm")
                            th(class="text-left text-xs font-medium text-neutral-500 uppercase tracking-wider") 이름
                            th(class="w-1 text-nowrap text-right text-xs font-medium text-neutral-500 uppercase tracking-wider") 크기
                            th(class="w-1 text-nowrap text-right text-xs font-medium text-neutral-500 uppercase tracking-wider") 수정된 날짜
                            th(class="w-20", *ngIf="accessLevel()")
                    tbody(class="text-sm divide-y divide-neutral-100")
                        tr(class="cursor-pointer hover:bg-neutral-50 transition-colors", *ngIf="current.id", class="*:px-3 *:py-2")
                            td(*ngIf="accessLevel()")
                            td(class="p-3", colspan=4, (click)="open(current.parent()); $event.stopPropagation();")
                                div(class="flex items-center max-w-[480px]")
                                    i(class="ti ti-folder mr-2 text-xl text-sky-400")
                                    span ..

                        tr(*ngIf="newFolder.type", class="*:p-3 hover:bg-neutral-50 transition-colors")
                            td(*ngIf="accessLevel()")
                            td(colspan=5)
                                div(class="flex items-center")
                                    i(class="ti ti-folder-plus mr-2 text-xl text-sky-400")
                                    input(class="w-full shadow-none border border-neutral-200 py-1.5 px-2 text-sm rounded-md max-w-[480px] focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400 placeholder-neutral-400", placeholder="새로운 폴더", [(ngModel)]="newFolder.title", (keyup.enter)="createFolder(current, false)", (keyup.esc)="cancelCreate(current, false)")
                                    span(class="cursor-pointer px-2 py-1 rounded-md text-red-400 ml-2 hover:bg-red-50 hover:text-red-500 transition-colors", (click)="cancelCreate(current, false)")
                                        i(class="ti ti-x")
                                    span(class="cursor-pointer px-2 py-1 rounded-md text-neutral-600 ml-1 hover:bg-neutral-100 transition-colors", (click)="createFolder(current, false)")
                                        i(class="ti ti-check")

                        ng-container(*ngFor="let file of current.getChildren()")
                            tr(
                                draggable="true",
                                class="*:p-3 hover:bg-neutral-50 transition-colors",
                                [class.bg-blue-50]="isSelected(file)",
                                [class.bg-neutral-100]="isDrop(file)",
                                (dragend)="dragend($event, file)",
                                (dragover)="dragover($event, file)",
                                (click)="select(file); $event.stopPropagation();",
                                (dblclick)="open(file); $event.stopPropagation();",
                            )
                                td(class="text-center !pl-5 !pr-0", *ngIf="accessLevel()")
                                    span(class="text-sm rounded-md px-2 py-0.5 cursor-pointer border transition-colors",
                                        [ngClass]="isSelected(file) ? '!bg-blue-500 !text-white !border-blue-500' : 'border-neutral-300 text-neutral-300 hover:border-neutral-400'",
                                        (click)="select(file); $event.stopPropagation();",
                                    )
                                        i(class="ti ti-check text-sm")
                                td
                                    div(class="flex items-center max-w-[480px]")
                                        i(class="mr-2 text-xl", [ngClass]="icon(file, false)")
                                        span(class="underline-offset-4 cursor-pointer text-neutral-700 hover:underline hover:text-blue-600 transition-colors", *ngIf="!file.editable", (click)="open(file); $event.stopPropagation();") {{file.title}}
                                        input(class="w-full shadow-none border border-neutral-200 py-1 px-2 text-sm rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-400", [(ngModel)]="file.rename", placeholder="폴더명", (keyup.enter)="file.update();", (keyup.esc)="file.editable=!file.editable;service.render();", *ngIf="file.editable", (click)="$event.stopPropagation();")
                                td(class="text-neutral-400 text-right text-nowrap") {{file.size}}
                                td(class="text-neutral-400 text-nowrap") {{file.modified}}
                                td(class="w-20 !pl-0 !pr-3", *ngIf="accessLevel()")
                                    ng-container(*ngIf="!file.editable")
                                        span(class="cursor-pointer px-2 py-1 rounded-md text-neutral-400 mr-1 hover:bg-neutral-100 hover:text-neutral-600 transition-colors", (click)="rename(file); $event.stopPropagation();")
                                            i(class="ti ti-cursor-text")
                                    span(class="cursor-pointer px-2 py-1 rounded-md text-red-400 hover:bg-red-50 hover:text-red-500 transition-colors", (click)="delete(file); $event.stopPropagation();")
                                        i(class="ti ti-trash")

                        tr(*ngIf="!newFolder.type && current.getChildren().length == 0", class="*:p-3")
                            td(colspan=5)
                                div(class="flex flex-col items-center justify-center py-16 text-center")
                                    i(class="ti ti-cloud-off text-5xl text-neutral-300 mb-4")
                                    p(class="text-sm text-neutral-500") 업로드된 파일이 없습니다

        //- 이슈파일 탭
        ng-container(*ngIf="tab == 'attachment'")
            div(class="flex flex-col flex-auto overflow-hidden")
                div(class="flex-auto overflow-auto")
                    table(class="w-full")
                        thead(class="sticky top-0 z-50 bg-neutral-50 text-xs")
                            tr(class="*:p-3")
                                th(class="pl-5 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider") 이름
                                th(class="w-1 pr-5 text-right text-nowrap text-xs font-medium text-neutral-500 uppercase tracking-wider") 생성된 날짜
                        tbody(class="text-sm divide-y divide-neutral-100")
                            tr(*ngFor="let file of attachment.list", class="hover:bg-neutral-50 transition-colors *:p-3")
                                td(class="pl-5")
                                    div
                                        i(class="mr-2", [ngClass]="icon(file, false)")
                                        span(class="mr-2 font-medium text-neutral-800", *ngIf="file.issue_title") [{{file.issue_title}}]
                                        a(class="underline-offset-4 text-neutral-700 hover:underline hover:text-blue-600 transition-colors", [href]="imageUrl(file, false)", target="_blank") {{file.filename}}
                                td(class="pr-5 text-neutral-400 text-nowrap") {{file.created}}
                            tr(*ngIf="attachment.list.length === 0")
                                td(colspan=2)
                                    div(class="flex flex-col items-center justify-center py-16 text-center")
                                        i(class="ti ti-cloud-off text-5xl text-neutral-300 mb-4")
                                        p(class="text-sm text-neutral-500") 업로드된 파일이 없습니다

                div(class="py-3 border-t border-neutral-200")
                    wiz-component-pagination(
                        [current]="attachment.page",
                        [start]="attachment.start",
                        [end]="attachment.end",
                        (pageMove)="loadAttachment($event)")

        //- 회의록파일 탭
        ng-container(*ngIf="tab == 'meeting'")
            div(class="flex flex-col flex-auto overflow-hidden")
                div(class="flex-auto overflow-auto")
                    table(class="w-full")
                        thead(class="sticky top-0 z-50 bg-neutral-50 text-xs")
                            tr(class="*:p-3")
                                th(class="pl-5 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider") 이름
                                th(class="w-1 pr-5 text-right text-nowrap text-xs font-medium text-neutral-500 uppercase tracking-wider") 생성된 날짜
                        tbody(class="text-sm divide-y divide-neutral-100")
                            tr(*ngFor="let file of attachment.list", class="hover:bg-neutral-50 transition-colors *:p-3")
                                td(class="pl-5")
                                    div
                                        i(class="mr-2", [ngClass]="icon(file, false)")
                                        a(class="underline-offset-4 text-neutral-700 hover:underline hover:text-blue-600 transition-colors", [href]="imageUrl(file, false)", target="_blank") {{file.filename}}
                                td(class="pr-5 text-neutral-400 text-nowrap") {{file.created}}
                            tr(*ngIf="attachment.list.length === 0")
                                td(colspan=2)
                                    div(class="flex flex-col items-center justify-center py-16 text-center")
                                        i(class="ti ti-cloud-off text-5xl text-neutral-300 mb-4")
                                        p(class="text-sm text-neutral-500") 업로드된 파일이 없습니다

                div(class="py-3 border-t border-neutral-200")
                    wiz-component-pagination(
                        [current]="attachment.page",
                        [start]="attachment.start",
                        [end]="attachment.end",
                        (pageMove)="loadAttachment($event)")

        //- 사진 탭
        ng-container(*ngIf="tab == 'photo'")
            div(class="flex flex-col overflow-hidden py-2 w-full")
                div(class="overflow-auto flex flex-auto flex-wrap p-2")
                    div(class="p-2 w-1/3", *ngFor="let photo of attachment.list")
                        div(class="border border-neutral-200 rounded-lg overflow-hidden cursor-pointer relative group")
                            div(class="bg-no-repeat bg-center bg-cover bg-neutral-100 rounded pt-[100%]", [style.background-image]="imageUrl(photo)")
                            div(class="opacity-0 absolute z-10 inset-0 flex items-center justify-center bg-black/50 group-hover:opacity-100 transition-opacity")
                                a(class="py-1.5 px-4 rounded-md bg-white text-neutral-700 text-sm hover:bg-neutral-100 transition-colors", [href]="imageUrl(photo, false)", target="_blank")
                                    i(class="ti ti-download mr-1")
                                    span 다운로드

                div(class="pb-1 pt-3 border-t border-neutral-200")
                    wiz-component-pagination(
                        [current]="attachment.page",
                        [start]="attachment.start",
                        [end]="attachment.end",
                        (pageMove)="loadAttachment($event)")
