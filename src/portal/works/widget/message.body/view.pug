.flex.flex-col.p-5([ngClass]="msg.parent_id && 'py-2 pl-9'")
    .flex.items-center
        .font-semibold.text-sm.text-neutral-900(*ngIf="project.member.map[msg.user_id]")
            i.mr-2.ti.ti-arrow-back-up.text-neutral-400(*ngIf="msg.parent_id")
            span {{project.member.map[msg.user_id].name}}
        .ml-auto
        .ml-2
        span.text-xs.text-neutral-400 {{project.display.date(msg.created)}}
        ng-container(*ngIf="!msg.parent_id")
            .ml-2
            span.cursor-pointer.text-neutral-400(*ngIf="cache.message.parent_id != msg.id", class="hover:text-neutral-600")
                i.ti.ti-arrow-forward-up((click)="event.replyMessage(msg)")
            .ml-2
            .cursor-pointer(*ngIf="msg.type != 'log'")
                i.ti.ti-star.text-neutral-300((click)="event.favoriteMessage(msg)", *ngIf="msg.favorite == 0", class="hover:text-yellow-500")
                i.ti.ti-star-filled.text-yellow-500((click)="event.favoriteMessage(msg)", *ngIf="msg.favorite == 1")

    div(*ngIf="msg.attachment && msg.attachment.length > 0", class="mb-[6px]")
        ng-container(*ngFor="let file of msg.attachment")
            a.inline-flex.items-center.gap-1.rounded-md.text-xs.bg-neutral-100.text-neutral-600.mr-1.mt-1.transition(class="hover:bg-neutral-200 px-2 py-0.5 overflow-hidden max-w-[180px] text-ellipsis text-nowrap", [attr.href]="project.downloadUrl(file.id, file.filename)", target="_blank", [title]="file.filename")
                i.ti.ti-download
                span {{file.filename}}

    .relative.break-all.text-sm.text-neutral-600(*ngIf="msg.type == 'log'") {{msg.message}}
    .relative.break-all.prose.text-sm(*ngIf="msg.type != 'log'", [innerHtml]="project.display.markdown(msg.message)")

.p-0.d-block(*ngIf="msg.images && msg.images.length > 0")
    ng-container(*ngFor="let grid of event.imageGrid(msg)")
        .flex.flex-wrap.p-0.m-0
            ng-container(*ngFor="let image of grid.items")
                .bg-neutral-100.p-0.m-0([ngClass]="grid.size")
                    a.relative.block.w-full.bg-center.bg-no-repeat.bg-cover.cursor-pointer([style.background-image]="image.load ? event.imageUrl(image) : ''", [attr.href]="project.downloadUrl(image.id, image.filename)", target="_blank")
                        ng-container(*ngIf="grid.size == 'w-1/4'")
                            svg(class="hover:border-4 hover:border-blue-500", viewBox="0 0 100 100")
                                rect(width="100", height="100", style="fill:rgba(255,255,255,0);")
                        ng-container(*ngIf="grid.size == 'w-1/3'")
                            svg(class="hover:border-4 hover:border-blue-500", viewBox="0 0 100 70")
                                rect(width="100", height="70", style="fill:rgba(255,255,255,0);")
                        ng-container(*ngIf="grid.size == 'w-1/2'")
                            svg(class="hover:border-4 hover:border-blue-500", viewBox="0 0 100 50")
                                rect(width="100", height="50", style="fill:rgba(255,255,255,0);")
                        ng-container(*ngIf="grid.size == 'w-full'")
                            svg(class="hover:border-4 hover:border-blue-500", viewBox="0 0 100 50")
                                rect(width="100", height="50", style="fill:rgba(255,255,255,0);")
